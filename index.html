<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Simulatore Economia</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f0f0f0; padding: 20px; }
    .container { max-width: 960px; margin: auto; background: white; padding: 20px; border-radius: 10px; }
    .topbar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    .item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #ccc; }
    .item span { margin-right: 10px; }
    button { padding: 5px 10px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Simulatore Economico</h1>
    <div class="topbar">
      <div><strong>Anno:</strong> <span id="anno">2025</span></div>
      <div><strong>Soldi:</strong> â‚¬<span id="soldi">100000</span></div>
      <button onclick="avanzaAnno()">+1 Anno</button>
    </div>

    <h2>Mercato</h2>
    <div id="mercato"></div>

    <h2>Inventario</h2>
    <div id="inventario"></div>
  </div>

  <script>
    let stato = JSON.parse(localStorage.getItem("stato")) || {
      anno: 2025,
      soldi: 100000,
      oggettiPosseduti: [],
      oggetti: generaOggetti()
    };

    function generaOggetti() {
      const lista = [
        ["ðŸ ", "Appartamento a Milano", 350000], ["ðŸ¢", "Loft a New York", 1200000], ["ðŸšï¸", "Casa abbandonata", 20000],
        ["ðŸ¡", "Villetta in Toscana", 450000], ["ðŸ˜ï¸", "Condominio a Berlino", 750000], ["ðŸ¤", "Edificio commerciale", 1500000],
        ["ðŸ—ï¸", "Terreno edificabile", 250000], ["ðŸŒ¾", "Terreno agricolo", 60000], ["ðŸš—", "Fiat Panda", 12000],
        ["ðŸš™", "Dacia Duster", 17000], ["ðŸŽï¸", "Lamborghini Aventador", 400000], ["ðŸš•", "Toyota Prius", 21000],
        ["ðŸš“", "BMW Serie 3", 38000], ["ðŸš‘", "Mercedes Classe S", 105000], ["ðŸ›»", "Pickup Ford Raptor", 58000],
        ["ðŸš", "Van Volkswagen", 25000], ["ðŸ›µ", "Piaggio Vespa", 3200], ["ðŸï¸", "Harley Davidson", 22000],
        ["ðŸ›´", "Monopattino elettrico", 800], ["ðŸ“±", "iPhone 15 Pro", 1350], ["ðŸ’»", "MacBook Pro M3", 2500],
        ["âŒš", "Apple Watch", 450], ["ðŸ“º", "TV OLED LG", 1600], ["ðŸ“·", "Canon EOS R5", 3200],
        ["ðŸŽ®", "PlayStation 5", 550], ["ðŸ•¹ï¸", "PC gaming RTX", 2000], ["ðŸŽ§", "AirPods Max", 600],
        ["ðŸ›ï¸", "Letto matrimoniale", 700], ["ðŸª‘", "Sedia da gaming", 350], ["ðŸ§¼", "Set bagno lusso", 280],
        ["ðŸ§¥", "Giacca Canada Goose", 1100], ["ðŸ‘Ÿ", "Nike Air Jordan", 200], ["ðŸ‘”", "Abito su misura", 1300],
        ["ðŸ§³", "Valigia Louis Vuitton", 3500], ["ðŸ’¼", "Borsa Prada", 2900], ["ðŸ’", "Anello diamante", 5000],
        ["ðŸ–¼ï¸", "Quadro d'arte", 95000], ["ðŸ—¿", "Scultura in marmo", 120000], ["ðŸ’Š", "Cocaina (1kg)", 35000],
        ["ðŸ§ª", "MDMA (100g)", 7000], ["ðŸš¬", "Sigarette (1 pallet)", 3000], ["ðŸ“¦", "Pacco misterioso", 1000],
        ["ðŸ”«", "Pistola Glock", 900], ["ðŸ”ª", "Coltello militare", 350], ["âš”ï¸", "Katana giapponese", 1500],
        ["ðŸ§¯", "Attrezzatura antincendio", 800], ["ðŸ§°", "Set attrezzi pro", 650], ["ðŸ”Œ", "Generatore diesel", 1200],
        ["ðŸªœ", "Scala telescopica", 350], ["ðŸ“¡", "Antenna satellitare", 2100], ["ðŸ›°ï¸", "Micro satellite", 180000],
        ["ðŸ“¡", "Router Starlink", 600], ["ðŸ”­", "Telescopio professionale", 9000], ["ðŸ“š", "Enciclopedia storica", 950],
        ["ðŸ“–", "Libro raro", 2000], ["ðŸ§ ", "Cervello in barattolo", 9999], ["ðŸ§¸", "Peluche raro", 850],
        ["ðŸª™", "Moneta dâ€™oro", 1800], ["ðŸ§¬", "DNA sintetico", 50000], ["ðŸ›¥ï¸", "Yacht piccolo", 80000],
        ["ðŸš¤", "Moto dâ€™acqua", 12000], ["ðŸ›¶", "Canoa in carbonio", 3000], ["ðŸš", "Elicottero privato", 980000],
        ["âœˆï¸", "Jet privato", 5200000], ["ðŸš€", "Viaggio suborbitale", 350000], ["ðŸ›¸", "Modello UFO", 999999],
        ["ðŸ’£", "Bomba finta", 150], ["ðŸ¦´", "Scheletro umano finto", 650], ["ðŸª¦", "Tomba VIP", 25000],
        ["ðŸ”®", "Sfera magica", 999], ["ðŸ“€", "CD autografato", 150], ["ðŸ§¿", "Amuleto protettivo", 70]
      ];
      return lista.map(([emoji, nome, prezzo]) => ({
        emoji,
        nome,
        storico: [prezzo]
      }));
    }

    function aggiornaPrezzi() {
      for (let o of stato.oggetti) {
        const prec = o.storico[o.storico.length - 1];
        const delta = (Math.random() * 10 - 5) ** 2 * (Math.random() < 0.5 ? -1 : 1);
        const nuovo = Math.max(1, Math.floor(prec * (1 + delta / 100)));
        o.storico.push(nuovo);
      }
    }

    function avanzaAnno() {
      stato.anno++;
      aggiornaPrezzi();
      salva();
      render();
    }

    function compra(index) {
      const prezzo = stato.oggetti[index].storico.at(-1);
      if (stato.soldi >= prezzo) {
        stato.soldi -= prezzo;
        stato.oggettiPosseduti.push({ ...stato.oggetti[index] });
        salva();
        render();
      } else {
        alert("Non hai abbastanza soldi.");
      }
    }

    function salva() {
      localStorage.setItem("stato", JSON.stringify(stato));
    }

    function render() {
      document.getElementById("anno").textContent = stato.anno;
      document.getElementById("soldi").textContent = stato.soldi.toLocaleString();

      const m = document.getElementById("mercato");
      m.innerHTML = "";
      stato.oggetti.forEach((o, i) => {
        const prezzo = o.storico.at(-1);
        const prec = o.storico.at(-2) || prezzo;
        const delta = (((prezzo - prec) / prec) * 100).toFixed(2);
        const item = document.createElement("div");
        item.className = "item";
        item.innerHTML = `
          <span>${o.emoji} ${o.nome}</span>
          <span>â‚¬${prezzo.toLocaleString()} (<span style="color:${delta>=0?'green':'red'}">${delta}%</span>) 
          <button onclick="compra(${i})">Compra</button></span>`;
        m.appendChild(item);
      });

      const inv = document.getElementById("inventario");
      inv.innerHTML = "";
      stato.oggettiPosseduti.forEach(o => {
        const prezzo = o.storico.at(-1);
        const item = document.createElement("div");
        item.className = "item";
        item.innerHTML = `<span>${o.emoji} ${o.nome}</span><span>Valore attuale: â‚¬${prezzo.toLocaleString()}</span>`;
        inv.appendChild(item);
      });
    }

    render();
  </script>
</body>
</html>
